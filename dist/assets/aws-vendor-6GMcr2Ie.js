const Ht="Logging",qt="NoHubcallbackProvidedException";var w;(function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"})(w||(w={}));const Re={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class E{constructor(t,n=w.WARN){this.name=t,this.level=n,this._pluggables=[]}_padding(t){return t<10?"0"+t:""+t}_ts(){const t=new Date;return[this._padding(t.getMinutes()),this._padding(t.getSeconds())].join(":")+"."+t.getMilliseconds()}configure(t){return t?(this._config=t,this._config):this._config}_log(t,...n){let o=this.level;E.LOG_LEVEL&&(o=E.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(o=window.LOG_LEVEL);const i=Re[o];if(!(Re[t]>=i))return;let r=console.log.bind(console);t===w.ERROR&&console.error&&(r=console.error.bind(console)),t===w.WARN&&console.warn&&(r=console.warn.bind(console)),E.BIND_ALL_LOG_LEVELS&&(t===w.INFO&&console.info&&(r=console.info.bind(console)),t===w.DEBUG&&console.debug&&(r=console.debug.bind(console)));const a=`[${t}] ${this._ts()} ${this.name}`;let c="";if(n.length===1&&typeof n[0]=="string")c=`${a} - ${n[0]}`,r(c);else if(n.length===1)c=`${a} ${n[0]}`,r(a,n[0]);else if(typeof n[0]=="string"){let d=n.slice(1);d.length===1&&(d=d[0]),c=`${a} - ${n[0]} ${d}`,r(`${a} - ${n[0]}`,d)}else c=`${a} ${n}`,r(a,n);for(const d of this._pluggables){const u={message:c,timestamp:Date.now()};d.pushLogs([u])}}log(...t){this._log(w.INFO,...t)}info(...t){this._log(w.INFO,...t)}warn(...t){this._log(w.WARN,...t)}error(...t){this._log(w.ERROR,...t)}debug(...t){this._log(w.DEBUG,...t)}verbose(...t){this._log(w.VERBOSE,...t)}addPluggable(t){t&&t.getCategoryName()===Ht&&(this._pluggables.push(t),t.configure(this._config))}listPluggables(){return this._pluggables}}E.LOG_LEVEL=null;E.BIND_ALL_LOG_LEVELS=!1;class T extends Error{constructor({message:t,name:n,recoverySuggestion:o,underlyingError:i,metadata:s}){if(super(t),this.name=n,this.underlyingError=i,this.recoverySuggestion=o,s){const{extendedRequestId:r,httpStatusCode:a,requestId:c}=s;this.metadata={extendedRequestId:r,httpStatusCode:a,requestId:c}}this.constructor=T,Object.setPrototypeOf(this,T.prototype)}}var b;(function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"})(b||(b={}));const at=(e,t=T)=>(n,o,i)=>{const{message:s,recoverySuggestion:r}=e[o];if(!n)throw new t({name:o,message:i?`${s} ${i}`:s,recoverySuggestion:r})},z=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",K=new E("Hub");class Jt{constructor(t){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}_remove(t,n){const o=this.listeners.get(t);if(!o){K.warn(`No listeners for ${t}`);return}this.listeners.set(t,[...o.filter(({callback:i})=>i!==n)])}dispatch(t,n,o,i){typeof t=="string"&&this.protectedChannels.indexOf(t)>-1&&(i===z||K.warn(`WARNING: ${t} is protected and dispatching on it can have unintended consequences`));const s={channel:t,payload:{...n},source:o,patternInfo:[]};try{this._toListeners(s)}catch(r){K.error(r)}}listen(t,n,o="noname"){let i;if(typeof n!="function")throw new T({name:qt,message:"No callback supplied to Hub"});i=n;let s=this.listeners.get(t);return s||(s=[],this.listeners.set(t,s)),s.push({name:o,callback:i}),()=>{this._remove(t,i)}}_toListeners(t){const{channel:n,payload:o}=t,i=this.listeners.get(n);i&&i.forEach(s=>{K.debug(`Dispatching to ${n} with `,o);try{s.callback(t)}catch(r){K.error(r)}})}}const oe=new Jt("__default__"),Yt=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new T({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},Qt={convert(e,t){let n=e;return t!=null&&t.urlSafe&&(n=n.replace(/-/g,"+").replace(/_/g,"/")),Yt()(n)}};var A;(function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"})(A||(A={}));const Xt={[A.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[A.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[A.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[A.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[A.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},ct=at(Xt);function m(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,ct(t,A.AuthUserPoolException)}function j(e){const t=!!(e!=null&&e.identityPoolId);ct(t,A.InvalidIdentityPoolIdException)}function L(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{const o=t[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(Qt.convert(o).split("").map(r=>`%${`00${r.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),s=JSON.parse(i);return{toString:()=>e,payload:s}}catch{throw new Error("Invalid token payload")}}const dt=e=>{const t=Reflect.ownKeys(e);for(const n of t){const o=e[n];(o&&typeof o=="object"||typeof o=="function")&&dt(o)}return Object.freeze(e)},Zt=new E("parseAWSExports"),en={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},tn=(e={})=>{var _e,Ee,ve,Ce,Te,Ae;if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new T({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:o,aws_appsync_region:i,aws_bots_config:s,aws_cognito_identity_pool_id:r,aws_cognito_sign_up_verification_method:a,aws_cognito_mfa_configuration:c,aws_cognito_mfa_types:d,aws_cognito_password_protection_settings:u,aws_cognito_verification_mechanisms:g,aws_cognito_signup_attributes:h,aws_cognito_social_providers:S,aws_cognito_username_attributes:_,aws_mandatory_sign_in:Kt,aws_mobile_analytics_app_id:ge,aws_mobile_analytics_app_region:Ut,aws_user_files_s3_bucket:fe,aws_user_files_s3_bucket_region:Mt,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:Nt,aws_user_pools_id:ye,aws_user_pools_web_client_id:Lt,geo:Ie,oauth:Z,predictions:k,aws_cloud_logic_custom:pe,Notifications:Vt,modelIntrospection:me}=e,I={};ge&&(I.Analytics={Pinpoint:{appId:ge,region:Ut}});const{InAppMessaging:R,Push:D}=Vt??{};if(R!=null&&R.AWSPinpoint||D!=null&&D.AWSPinpoint){if(R!=null&&R.AWSPinpoint){const{appId:f,region:O}=R.AWSPinpoint;I.Notifications={InAppMessaging:{Pinpoint:{appId:f,region:O}}}}if(D!=null&&D.AWSPinpoint){const{appId:f,region:O}=D.AWSPinpoint;I.Notifications={...I.Notifications,PushNotification:{Pinpoint:{appId:f,region:O}}}}}if(Array.isArray(s)&&(I.Interactions={LexV1:Object.fromEntries(s.map(f=>[f.name,f]))}),o){const f=en[n];f||Zt.debug(`Invalid authentication type ${n}. Falling back to IAM.`),I.API={GraphQL:{endpoint:o,apiKey:t,region:i,defaultAuthMode:f??"iam"}},me&&(I.API.GraphQL.modelIntrospection=me)}const $t=c?{status:c&&c.toLowerCase(),totpEnabled:(d==null?void 0:d.includes("TOTP"))??!1,smsEnabled:(d==null?void 0:d.includes("SMS"))??!1}:void 0,Gt=u?{minLength:u.passwordPolicyMinLength,requireLowercase:((_e=u.passwordPolicyCharacters)==null?void 0:_e.includes("REQUIRES_LOWERCASE"))??!1,requireUppercase:((Ee=u.passwordPolicyCharacters)==null?void 0:Ee.includes("REQUIRES_UPPERCASE"))??!1,requireNumbers:((ve=u.passwordPolicyCharacters)==null?void 0:ve.includes("REQUIRES_NUMBERS"))??!1,requireSpecialCharacters:((Ce=u.passwordPolicyCharacters)==null?void 0:Ce.includes("REQUIRES_SYMBOLS"))??!1}:void 0,Wt=Array.from(new Set([...g??[],...h??[]])).reduce((f,O)=>({...f,[O.toLowerCase()]:{required:!0}}),{}),we=(_==null?void 0:_.includes("EMAIL"))??!1,Se=(_==null?void 0:_.includes("PHONE_NUMBER"))??!1;(r||ye)&&(I.Auth={Cognito:{identityPoolId:r,allowGuestAccess:Kt!=="enable",signUpVerificationMethod:a,userAttributes:Wt,userPoolClientId:Lt,userPoolId:ye,mfa:$t,passwordFormat:Gt,loginWith:{username:!(we||Se),email:we,phone:Se}}});const Ft=Z?Object.keys(Z).length>0:!1,Bt=S?S.length>0:!1;if(I.Auth&&Ft&&(I.Auth.Cognito.loginWith={...I.Auth.Cognito.loginWith,oauth:{...nn(Z),...Bt&&{providers:on(S)}}}),fe&&(I.Storage={S3:{bucket:fe,region:Mt,dangerouslyConnectToHttpEndpointForTesting:Nt}}),Ie){const{amazon_location_service:f}=Ie;I.Geo={LocationService:{maps:f.maps,geofenceCollections:f.geofenceCollections,searchIndices:f.search_indices,region:f.region}}}if(pe&&(I.API={...I.API,REST:pe.reduce((f,O)=>{const{name:jt,endpoint:zt,region:ke,service:Pe}=O;return{...f,[jt]:{endpoint:zt,...Pe?{service:Pe}:void 0,...ke?{region:ke}:void 0}}},{})}),k){const{VoiceId:f}=((Ae=(Te=k==null?void 0:k.convert)==null?void 0:Te.speechGenerator)==null?void 0:Ae.defaults)??{};I.Predictions=f?{...k,convert:{...k.convert,speechGenerator:{...k.convert.speechGenerator,defaults:{voiceId:f}}}}:k}return I},De=e=>(e==null?void 0:e.split(","))??[],nn=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:o,responseType:i})=>({domain:e,scopes:t,redirectSignIn:De(n),redirectSignOut:De(o),responseType:i}),on=e=>e.map(t=>{const n=t.toLowerCase();return n.charAt(0).toUpperCase()+n.slice(1)}),sn=Symbol("oauth-listener"),p=[];for(let e=0;e<256;++e)p.push((e+256).toString(16).slice(1));function rn(e,t=0){return(p[e[t+0]]+p[e[t+1]]+p[e[t+2]]+p[e[t+3]]+"-"+p[e[t+4]]+p[e[t+5]]+"-"+p[e[t+6]]+p[e[t+7]]+"-"+p[e[t+8]]+p[e[t+9]]+"-"+p[e[t+10]]+p[e[t+11]]+p[e[t+12]]+p[e[t+13]]+p[e[t+14]]+p[e[t+15]]).toLowerCase()}let ee;const an=new Uint8Array(16);function cn(){if(!ee){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ee=crypto.getRandomValues.bind(crypto)}return ee(an)}const dn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Oe={randomUUID:dn};function un(e,t,n){var i;if(Oe.randomUUID&&!t&&!e)return Oe.randomUUID();e=e||{};const o=e.random??((i=e.rng)==null?void 0:i.call(e))??cn();if(o.length<16)throw new Error("Random bytes length must be >= 16");if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){if(n=n||0,n<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let s=0;s<16;++s)t[n+s]=o[s];return t}return rn(o)}function ln(e){const{version:t}=e;return t?t.startsWith("1"):!1}function hn(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:o}=e;return{S3:{bucket:t,region:n,buckets:o&&vn(o)}}}function gn(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:o,password_policy:i,mfa_configuration:s,mfa_methods:r,unauthenticated_identities_enabled:a,oauth:c,username_attributes:d,standard_required_attributes:u,groups:g}=e,h={Cognito:{userPoolId:t,userPoolClientId:n,groups:g}};return o&&(h.Cognito={...h.Cognito,identityPoolId:o}),i&&(h.Cognito.passwordFormat={requireLowercase:i.require_lowercase,requireNumbers:i.require_numbers,requireUppercase:i.require_uppercase,requireSpecialCharacters:i.require_symbols,minLength:i.min_length??6}),s&&(h.Cognito.mfa={status:En(s),smsEnabled:r==null?void 0:r.includes("SMS"),totpEnabled:r==null?void 0:r.includes("TOTP")}),a&&(h.Cognito.allowGuestAccess=a),c&&(h.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:c.response_type==="token"?"token":"code",scopes:c.scopes,providers:_n(c.identity_providers)}}),d&&(h.Cognito.loginWith={...h.Cognito.loginWith,email:d.includes("email"),phone:d.includes("phone_number"),username:d.includes("username")}),u&&(h.Cognito.userAttributes=u.reduce((S,_)=>({...S,[_]:{required:!0}}),{})),h}function fn(e){if(!(e!=null&&e.amazon_pinpoint))return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}function yn(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:o,search_indices:i}=e;return{LocationService:{region:t,searchIndices:i,geofenceCollections:n,maps:o}}}function In(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:o,api_key:i,model_introspection:s}=e;return{GraphQL:{endpoint:o,defaultAuthMode:ut(n),region:t,apiKey:i,modelIntrospection:s}}}function pn(e){if(!(e!=null&&e.events))return;const{url:t,aws_region:n,api_key:o,default_authorization_type:i}=e.events;return{Events:{endpoint:t,defaultAuthMode:ut(i),region:n,apiKey:o}}}function mn(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:o}=e,i=n.includes("IN_APP_MESSAGING"),s=n.includes("APNS")||n.includes("FCM");if(!(i||s))return;const r={};return i&&(r.InAppMessaging={Pinpoint:{appId:o,region:t}}),s&&(r.PushNotification={Pinpoint:{appId:o,region:t}}),r}function wn(e){const t={};if(e.storage&&(t.Storage=hn(e.storage)),e.auth&&(t.Auth=gn(e.auth)),e.analytics&&(t.Analytics=fn(e.analytics)),e.geo&&(t.Geo=yn(e.geo)),e.data&&(t.API=In(e.data)),e.custom){const n=pn(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=mn(e.notifications)),t}const Sn={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function ut(e){return Sn[e]}const be={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function _n(e=[]){return e.reduce((t,n)=>(be[n]!==void 0&&t.push(be[n]),t),[])}function En(e){return e==="OPTIONAL"?"optional":e==="REQUIRED"?"on":"off"}function vn(e){const t={};return e.forEach(({name:n,bucket_name:o,aws_region:i,paths:s})=>{if(n in t)throw new Error(`Duplicate friendly name found: ${n}. Name must be unique.`);const r=s?Object.entries(s).reduce((a,[c,d])=>(d!==void 0&&(a[c]=d),a),{}):void 0;t[n]={bucketName:o,region:i,paths:r}}),t}const lt=e=>Object.keys(e).some(t=>t.startsWith("aws_"))?tn(e):ln(e)?wn(e):e,Cn=e=>new TextEncoder().encode(e);typeof Buffer<"u"&&Buffer.from;for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`)}var y;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(y||(y={}));var xe;(function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(xe||(xe={}));var Ke;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"})(Ke||(Ke={}));var Ue;(function(e){e.Record="1",e.IdentifyUser="2"})(Ue||(Ue={}));var Me;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(Me||(Me={}));var Ne;(function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"})(Ne||(Ne={}));var Le;(function(e){e.Subscribe="1",e.GraphQl="2"})(Le||(Le={}));var Ve;(function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"})(Ve||(Ve={}));var $e;(function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"})($e||($e={}));var Ge;(function(e){e.None="0"})(Ge||(Ge={}));var We;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})(We||(We={}));var Fe;(function(e){e.Subscribe="1"})(Fe||(Fe={}));var Be;(function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"})(Be||(Be={}));var je;(function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"})(je||(je={}));const Tn="6.15.4",q=()=>typeof global<"u",x=()=>typeof window<"u",ht=()=>typeof document<"u",ce=()=>typeof process<"u",V=(e,t)=>!!Object.keys(e).find(n=>n.startsWith(t));var ze={};function An(){const e=o=>o.startsWith("_react")||o.startsWith("__react"),t=o=>Object.keys(o).find(e),n=()=>Array.from(document.querySelectorAll("[id]"));return ht()&&n().some(t)}function kn(){return ce()&&typeof ze<"u"&&!!Object.keys(ze).find(e=>e.includes("react"))}function Pn(){return x()&&V(window,"__VUE")}function Rn(){return q()&&V(global,"__VUE")}var He={};function Dn(){return x()&&V(window,"__SVELTE")}function On(){return ce()&&typeof He<"u"&&!!Object.keys(He).find(e=>e.includes("svelte"))}function bn(){return x()&&window.next&&typeof window.next=="object"}function xn(){return q()&&(V(global,"__next")||V(global,"__NEXT"))}function Kn(){return x()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function Un(){return q()&&typeof global.__NUXT_PATHS__<"u"}var qe={};function Mn(){const e=!!(ht()&&document.querySelector("[ng-version]")),t=!!(x()&&typeof window.ng<"u");return e||t}function Nn(){var e;return ce()&&typeof qe=="object"&&((e=qe.npm_lifecycle_script)==null?void 0:e.startsWith("ng "))||!1}function Ln(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function Vn(){return q()&&typeof global.expo<"u"}function $n(){return x()}const Gn=[{platform:y.Expo,detectionMethod:Vn},{platform:y.ReactNative,detectionMethod:Ln},{platform:y.NextJs,detectionMethod:bn},{platform:y.Nuxt,detectionMethod:Kn},{platform:y.Angular,detectionMethod:Mn},{platform:y.React,detectionMethod:An},{platform:y.VueJs,detectionMethod:Pn},{platform:y.Svelte,detectionMethod:Dn},{platform:y.WebUnknown,detectionMethod:$n},{platform:y.NextJsSSR,detectionMethod:xn},{platform:y.NuxtSSR,detectionMethod:Un},{platform:y.ReactSSR,detectionMethod:kn},{platform:y.VueJsSSR,detectionMethod:Rn},{platform:y.AngularSSR,detectionMethod:Nn},{platform:y.SvelteSSR,detectionMethod:On}];function Wn(){var e;return((e=Gn.find(t=>t.detectionMethod()))==null?void 0:e.platform)||y.ServerSideUnknown}let N;const te=[];let ie=!1;const Fn=10,Bn=10,jn=1e3,gt=()=>{var e;if(!N){if(N=Wn(),ie)for(;te.length;)(e=te.pop())==null||e();else te.forEach(t=>{t()});Je(y.ServerSideUnknown,Fn),Je(y.WebUnknown,Bn)}return N};function zn(){N=void 0}function Je(e,t){N===e&&!ie&&setTimeout(()=>{zn(),ie=!0,setTimeout(gt,jn)},t)}const Hn={},qn=(e,t)=>{var n,o;return(o=(n=Hn[e])==null?void 0:n[t])==null?void 0:o.additionalDetails},Jn="aws-amplify",Yn=e=>e.replace(/\+.*/,""),Qn=({category:e,action:t}={})=>{const n=[[Jn,Yn(Tn)]];if(e&&n.push([e,t]),n.push(["framework",gt()]),e&&t){const o=qn(e,t);o&&o.forEach(i=>{n.push(i)})}return n},de=e=>Qn(e).map(([o,i])=>o&&i?`${o}/${i}`:o).join(" "),Xn=()=>typeof window<"u"&&typeof window.document<"u",Ye=new E("Auth");class Zn{configure(t,n){var o,i;this.authConfig=t,this.authOptions=n,t&&((o=t.Cognito)!=null&&o.userPoolEndpoint)&&Ye.warn(Qe("Amazon Cognito User Pool")),t&&((i=t.Cognito)!=null&&i.identityPoolEndpoint)&&Ye.warn(Qe("Amazon Cognito Identity Pool"))}async fetchAuthSession(t={}){var s,r,a,c,d,u;let n,o;const i=await this.getTokens(t);return i?(o=(r=(s=i.accessToken)==null?void 0:s.payload)==null?void 0:r.sub,n=await((c=(a=this.authOptions)==null?void 0:a.credentialsProvider)==null?void 0:c.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:i,authenticated:!0,forceRefresh:t.forceRefresh}))):n=await((u=(d=this.authOptions)==null?void 0:d.credentialsProvider)==null?void 0:u.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:t.forceRefresh})),{tokens:i,credentials:n==null?void 0:n.credentials,identityId:n==null?void 0:n.identityId,userSub:o}}async clearCredentials(){var t,n;await((n=(t=this.authOptions)==null?void 0:t.credentialsProvider)==null?void 0:n.clearCredentialsAndIdentityId())}async getTokens(t){var n,o;return await((o=(n=this.authOptions)==null?void 0:n.tokenProvider)==null?void 0:o.getTokens(t))??void 0}}const Qe=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;class eo{constructor(){this.oAuthListener=void 0,this.isConfigured=!1,this.resourcesConfig={},this.libraryOptions={},this.Auth=new Zn}configure(t,n){const o=lt(t);this.resourcesConfig=o,n&&(this.libraryOptions=n),this.resourcesConfig=dt(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),oe.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",z),this.notifyOAuthListener(),this.isConfigured=!0}getConfig(){return this.isConfigured||console.warn("Amplify has not been configured. Please call Amplify.configure() before using this service."),this.resourcesConfig}[sn](t){var n,o,i;(o=(n=this.resourcesConfig.Auth)==null?void 0:n.Cognito.loginWith)!=null&&o.oauth?t((i=this.resourcesConfig.Auth)==null?void 0:i.Cognito):this.oAuthListener=t}notifyOAuthListener(){var t,n,o;!((n=(t=this.resourcesConfig.Auth)==null?void 0:t.Cognito.loginWith)!=null&&n.oauth)||!this.oAuthListener||(this.oAuthListener((o=this.resourcesConfig.Auth)==null?void 0:o.Cognito),this.oAuthListener=void 0)}}const P=new eo,J=e=>{const{headers:t,statusCode:n}=e;return{...to(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},to=e=>typeof(e==null?void 0:e.$metadata)=="object",G=async e=>{if(!e||e.statusCode<300)return;const t=await Y(e),o=(r=>{const[a]=r.toString().split(/[,:]+/);return a.includes("#")?a.split("#")[1]:a})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),i=t.message??t.Message??"Unknown error",s=new Error(i);return Object.assign(s,{name:o,$metadata:J(e)})},Y=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:J(e)})},ue=(e,t,n,o)=>async(i,s)=>{const r={...o,...i},a=await r.endpointResolver(r,s),c=await t(s,a),d=await e(c,{...r});return n(d)},no=300*1e3;function oo(e=no){return o=>{const i=2**o*100+100*Math.random();return i>e?!1:i}}const ft=3,Xe="amz-sdk-invocation-id",io="amz-sdk-request",Ze=300*1e3,yt=e=>{const n=oo(Ze)(e);return n===!1?Ze:n},so=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],ro=e=>!!e&&so.includes(e),It=e=>async(t,n)=>{const o=n??await e(t)??void 0,i=(o==null?void 0:o.code)||(o==null?void 0:o.name),s=t==null?void 0:t.statusCode;return{retryable:lo(n)||uo(s,i)||ro(i)||ho(s,i)}},ao=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],co=["TimeoutError","RequestTimeout","RequestTimeoutException"],uo=(e,t)=>e===429||!!t&&ao.includes(t),lo=e=>[b.NetworkError,"ERR_NETWORK"].includes(e==null?void 0:e.name),ho=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&co.includes(t),pt="cognito-identity",mt={service:pt,retryDecider:It(G),computeDelay:yt,cache:"no-store"},go=({maxAttempts:e=ft,retryDecider:t,computeDelay:n,abortSignal:o})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(i,s)=>async function(a){let c,d=s.attemptsCount??0,u;const g=()=>{if(u)return et(u,d),u;throw et(c,d),c};for(;!(o!=null&&o.aborted)&&d<e;){try{u=await i(a),c=void 0}catch(_){c=_,u=void 0}d=(s.attemptsCount??0)>d?s.attemptsCount??0:d+1,s.attemptsCount=d;const{isCredentialsExpiredError:h,retryable:S}=await t(u,c,s);if(S){if(s.isCredentialsExpired=!!h,!(o!=null&&o.aborted)&&d<e){const _=n(d);await fo(_,o)}continue}else return g()}if(o!=null&&o.aborted)throw new Error("Request aborted.");return g()}},fo=(e,t)=>{if(t!=null&&t.aborted)return Promise.resolve();let n,o;const i=new Promise(s=>{o=s,n=setTimeout(s,e)});return t==null||t.addEventListener("abort",function s(r){clearTimeout(n),t==null||t.removeEventListener("abort",s),o()}),i},et=(e,t)=>{Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata={...e.$metadata??{},attempts:t})},yo=un,Io=()=>e=>async function(n){return n.headers[Xe]||(n.headers[Xe]=yo()),e(n)},po=({maxAttempts:e=ft})=>(t,n)=>async function(i){const s=n.attemptsCount??0;return i.headers[io]=`attempt=${s+1}; max=${e}`,t(i)},mo=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(i){if(t.trim().length===0)return await n(i);{const s=e.toLowerCase();return i.headers[s]=i.headers[s]?`${i.headers[s]} ${t}`:t,await n(i)}},le=(e,t)=>(n,o)=>{const i={};let s=r=>e(r,o);for(let r=t.length-1;r>=0;r--){const a=t[r];s=a(o)(s,i)}return s(n)},ne=e=>{let t;return()=>(t||(t=e()),t)},wo=e=>!["HEAD","GET"].includes(e.toUpperCase()),So=async({url:e,method:t,headers:n,body:o},{abortSignal:i,cache:s,withCrossDomainCredentials:r})=>{var g;let a;try{a=await fetch(e,{method:t,headers:n,body:wo(t)?o:void 0,signal:i,cache:s,credentials:r?"include":"same-origin"})}catch(h){throw h instanceof TypeError?new T({name:b.NetworkError,message:"A network error has occurred.",underlyingError:h}):h}const c={};(g=a.headers)==null||g.forEach((h,S)=>{c[S.toLowerCase()]=h});const d={statusCode:a.status,headers:c,body:null},u=Object.assign(a.body??{},{text:ne(()=>a.text()),blob:ne(()=>a.blob()),json:ne(()=>a.json())});return{...d,body:u}},wt=le(So,[mo,Io,go,po]),_o=()=>e=>async function(n){return n.headers["cache-control"]="no-store",e(n)},St=le(wt,[_o]),_t=e=>(t,n)=>{const o=Eo(e),i=JSON.stringify(t);return vo(n,o,i)},Eo=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),vo=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),tt=e=>ue(St,_t("GetCredentialsForIdentity"),Co,{...mt,...e,userAgentValue:de()}),Co=async e=>{if(e.statusCode>=300)throw await G(e);const t=await Y(e);return{IdentityId:t.IdentityId,Credentials:To(t.Credentials),$metadata:J(e)}},To=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(e*1e3)}),Ao=e=>ue(St,_t("GetId"),ko,{...mt,...e,userAgentValue:de()}),ko=async e=>{if(e.statusCode>=300)throw await G(e);return{IdentityId:(await Y(e)).IdentityId,$metadata:J(e)}},Et={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Po={partitions:[Et,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},vt=e=>{const{partitions:t}=Po;for(const{regions:n,outputs:o,regionRegex:i}of t){const s=new RegExp(i);if(n.includes(e)||s.test(e))return o.dnsSuffix}return Et.outputs.dnsSuffix},Q=URL,Ro=({region:e})=>({url:new Q(`https://${pt}.${e}.${vt(e)}`)});class U extends T{constructor(){super({name:b.PlatformNotSupported,message:"Function not supported on current platform"})}}class Ct{constructor(t){this.storage=t}async setItem(t,n){if(!this.storage)throw new U;this.storage.setItem(t,n)}async getItem(t){if(!this.storage)throw new U;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new U;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new U;this.storage.clear()}}class Tt{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,n){this.storage.set(t,n)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}const At=new E("CoreStorageUtils"),Do=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{At.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new Tt},kt=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return At.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new Tt}};class Oo extends Ct{constructor(){super(Do())}}class bo extends Ct{constructor(){super(kt())}}class xo{constructor(t){this._storage=t}get storage(){if(!this._storage)throw new U;return this._storage}setItem(t,n){this.storage.setItem(t,n)}getItem(t){return this.storage.getItem(t)}removeItem(t){this.storage.removeItem(t)}clear(){this.storage.clear()}}class Ko extends xo{constructor(){super(kt())}}/*! js-cookie v3.0.5 | MIT */function W(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}var Uo={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function se(e,t){function n(i,s,r){if(!(typeof document>"u")){r=W({},t,r),typeof r.expires=="number"&&(r.expires=new Date(Date.now()+r.expires*864e5)),r.expires&&(r.expires=r.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in r)r[c]&&(a+="; "+c,r[c]!==!0&&(a+="="+r[c].split(";")[0]));return document.cookie=i+"="+e.write(s,i)+a}}function o(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],r={},a=0;a<s.length;a++){var c=s[a].split("="),d=c.slice(1).join("=");try{var u=decodeURIComponent(c[0]);if(r[u]=e.read(d,u),i===u)break}catch{}}return i?r[i]:r}}return Object.create({set:n,get:o,remove:function(i,s){n(i,"",W({},s,{expires:-1}))},withAttributes:function(i){return se(this.converter,W({},this.attributes,i))},withConverter:function(i){return se(W({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var F=se(Uo,{path:"/"});class Mo{constructor(t={}){const{path:n,domain:o,expires:i,sameSite:s,secure:r}=t;if(this.domain=o,this.path=n||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?i:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?r:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!s||!["strict","lax","none"].includes(s))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(s==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=s}}async setItem(t,n){F.set(t,n,this.getData())}async getItem(t){return F.get(t)??null}async removeItem(t){F.remove(t,this.getData())}async clear(){const t=F.get(),n=Object.keys(t).map(o=>this.removeItem(o));await Promise.all(n)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const X=new Oo;new bo;new Ko;const No=e=>{let t;return async(...n)=>t||(t=new Promise((o,i)=>{e(...n).then(s=>{o(s)}).catch(s=>{i(s)}).finally(()=>{t=void 0})}),t)};function nt({expiresAt:e,clockDrift:t,tolerance:n=5e3}){return Date.now()+t+n>e}class l extends T{constructor(t){super(t),this.constructor=l,Object.setPrototypeOf(this,l.prototype)}}function Lo(e){const t=e==null?void 0:e.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new l({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function re(e){if(!e||!e.includes(":"))throw new l({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}const Pt="UserUnAuthenticatedException",Vo="InvalidRedirectException",$o="InvalidAppSchemeException",Go="InvalidPreferredRedirectUrlException";new l({name:Vo,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."});new l({name:$o,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."});new l({name:Go,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});const Wo="InvalidOriginException";new l({name:Wo,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."});const Fo="TokenRefreshException";function Bo(e){if(!e||!e.idToken)throw new l({name:Pt,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const jo=new l({name:Fo,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),zo=new l({name:Pt,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function Ho(e){if(Yo(e))throw jo;if(!Jo(e))throw zo}const qo={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function Rt(e){return(e==null?void 0:e.accessToken)||(e==null?void 0:e.idToken)}function Jo(e){return Rt(e)&&(e==null?void 0:e.refreshToken)}function Yo(e){return Rt(e)&&!(e!=null&&e.refreshToken)}const Qo=e=>(t,n)=>{const o=Xo(e),i=JSON.stringify(t);return Zo(n,o,i)},Xo=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),Zo=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"});function $(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new l({name:b.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const ei=()=>async e=>{if(e.statusCode>=300){const t=await G(e);throw $(t),new l({name:t.name,message:t.message,metadata:t.$metadata})}return Y(e)},ti=()=>(e,t)=>async function(o){return o.headers["cache-control"]="no-store",e(o)},ni=le(wt,[ti]),Dt="cognito-idp",oi={service:Dt,retryDecider:It(G),computeDelay:yt,get userAgentValue(){return de()},cache:"no-store"},ii=({region:e})=>({url:new Q(`https://${Dt}.${e}.${vt(e)}`)}),si=({endpointOverride:e})=>t=>e?{url:new Q(e)}:ii(t),ri=e=>ue(ni,Qo("GetTokensFromRefreshToken"),ei(),{...oi,...e}),ai=async({tokens:e,authConfig:t,username:n})=>{var S;m(t==null?void 0:t.Cognito);const{userPoolId:o,userPoolClientId:i,userPoolEndpoint:s}=t.Cognito,r=Lo(o);Ho(e);const a=ri({endpointResolver:si({endpointOverride:s})}),{AuthenticationResult:c}=await a({region:r},{ClientId:i,RefreshToken:e.refreshToken,DeviceKey:(S=e.deviceMetadata)==null?void 0:S.deviceKey}),d=L((c==null?void 0:c.AccessToken)??""),u=c!=null&&c.IdToken?L(c.IdToken):void 0,{iat:g}=d.payload;if(!g)throw new l({name:"iatNotFoundException",message:"iat not found in access token"});const h=g*1e3-new Date().getTime();return{accessToken:d,idToken:u,clockDrift:h,refreshToken:(c==null?void 0:c.RefreshToken)??e.refreshToken,username:n}},ci=No(ai),di={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var H;(function(e){e.InvalidAuthTokens="InvalidAuthTokens"})(H||(H={}));const ui={[H.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},li=at(ui),ot="CognitoIdentityServiceProvider";class hi{getKeyValueStorage(){if(!this.keyValueStorage)throw new l({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{const t=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t.accessToken);if(!n)throw new l({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const o=L(n),i=await this.getKeyValueStorage().getItem(t.idToken),s=i?L(i):void 0,r=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,a=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",c=Number.parseInt(a),d=await this.getKeyValueStorage().getItem(t.signInDetails),u={accessToken:o,idToken:s,refreshToken:r,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:c,username:await this.getLastAuthUser()};return d&&(u.signInDetails=JSON.parse(d)),u}catch{return null}}async storeTokens(t){li(t!==void 0,H.InvalidAuthTokens);const n=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),n);const o=await this.getAuthKeys();await this.getKeyValueStorage().setItem(o.accessToken,t.accessToken.toString()),t.idToken?await this.getKeyValueStorage().setItem(o.idToken,t.idToken.toString()):await this.getKeyValueStorage().removeItem(o.idToken),t.refreshToken?await this.getKeyValueStorage().setItem(o.refreshToken,t.refreshToken):await this.getKeyValueStorage().removeItem(o.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(o.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(o.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(o.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails?await this.getKeyValueStorage().setItem(o.signInDetails,JSON.stringify(t.signInDetails)):await this.getKeyValueStorage().removeItem(o.signInDetails),await this.getKeyValueStorage().setItem(o.clockDrift,`${t.clockDrift}`)}async clearTokens(){const t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(t.oauthMetadata)])}async getDeviceMetadata(t){const n=await this.getAuthKeys(t),o=await this.getKeyValueStorage().getItem(n.deviceKey),i=await this.getKeyValueStorage().getItem(n.deviceGroupKey),s=await this.getKeyValueStorage().getItem(n.randomPasswordKey);return s&&i&&o?{deviceKey:o,deviceGroupKey:i,randomPassword:s}:null}async clearDeviceMetadata(t){const n=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(n.deviceKey),this.getKeyValueStorage().removeItem(n.deviceGroupKey),this.getKeyValueStorage().removeItem(n.randomPasswordKey)])}async getAuthKeys(t){var o;m((o=this.authConfig)==null?void 0:o.Cognito);const n=t??await this.getLastAuthUser();return gi(ot,`${this.authConfig.Cognito.userPoolClientId}.${n}`)}getLastAuthUserKey(){var n;m((n=this.authConfig)==null?void 0:n.Cognito);const t=this.authConfig.Cognito.userPoolClientId;return`${ot}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(t){const{oauthMetadata:n}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n,JSON.stringify(t))}async getOAuthMetadata(){const{oauthMetadata:t}=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t);return n&&JSON.parse(n)}}const gi=(e,t)=>he(di)(`${e}`,t);function he(e){const t=Object.values({...e});return(n,o)=>t.reduce((i,s)=>({...i,[s]:`${n}.${o}.${s}`}),{})}const it="amplify-signin-with-hostedUI",v="CognitoIdentityServiceProvider";class fi{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){m(this.cognitoConfig);const t=C(v,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){m(this.cognitoConfig);const t=C(v,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(it),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){m(this.cognitoConfig);const t=C(v,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){m(this.cognitoConfig);const n=C(v,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthState,t)}loadPKCE(){m(this.cognitoConfig);const t=C(v,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){m(this.cognitoConfig);const n=C(v,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){m(this.cognitoConfig);const t=C(v,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){m(this.cognitoConfig);const n=C(v,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.inflightOAuth,`${t}`)}async loadOAuthSignIn(){var s;m(this.cognitoConfig);const t=C(v,this.cognitoConfig.userPoolClientId),n=await this.keyValueStorage.getItem(it),[o,i]=((s=await this.keyValueStorage.getItem(t.oauthSignIn))==null?void 0:s.split(","))??[];return{isOAuthSignIn:o==="true"||n==="true",preferPrivateSession:i==="true"}}async storeOAuthSignIn(t,n=!1){m(this.cognitoConfig);const o=C(v,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(o.oauthSignIn,`${t},${n}`)}}const C=(e,t)=>he(qo)(e,t),st=new fi(X);class yi{constructor(){this.waitForInflightOAuth=Xn()?async()=>{if(await st.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,n)=>{}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){st.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new l({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new l({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(t){var r,a,c,d,u;let n;try{m((r=this.authConfig)==null?void 0:r.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,n=await this.getTokenStore().loadTokens();const o=await this.getTokenStore().getLastAuthUser();if(n===null)return null;const i=!!(n!=null&&n.idToken)&&nt({expiresAt:(((c=(a=n.idToken)==null?void 0:a.payload)==null?void 0:c.exp)??0)*1e3,clockDrift:n.clockDrift??0}),s=nt({expiresAt:(((u=(d=n.accessToken)==null?void 0:d.payload)==null?void 0:u.exp)??0)*1e3,clockDrift:n.clockDrift??0});return(t!=null&&t.forceRefresh||i||s)&&(n=await this.refreshTokens({tokens:n,username:o}),n===null)?null:{accessToken:n==null?void 0:n.accessToken,idToken:n==null?void 0:n.idToken,signInDetails:n==null?void 0:n.signInDetails}}async refreshTokens({tokens:t,username:n}){try{const{signInDetails:o}=t,i=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:n});return i.signInDetails=o,await this.setTokens({tokens:i}),oe.dispatch("auth",{event:"tokenRefresh"},"Auth",z),i}catch(o){return this.handleErrors(o)}}handleErrors(t){if($(t),t.name!==b.NetworkError&&this.clearTokens(),oe.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",z),t.name.startsWith("NotAuthorizedException"))return null;throw t}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}setOAuthMetadata(t){return this.getTokenStore().setOAuthMetadata(t)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}class Ii{constructor(){this.authTokenStore=new hi,this.authTokenStore.setKeyValueStorage(X),this.tokenOrchestrator=new yi,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(ci)}getTokens({forceRefresh:t}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:t})}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}}const M=new Ii,{tokenOrchestrator:Ci}=M,pi={identityId:"identityId"},mi=new E("DefaultIdentityIdStore");class Ot{setAuthConfig(t){j(t.Cognito),this.authConfig=t,this._authKeys=wi("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=t}async loadIdentityId(){var t;j((t=this.authConfig)==null?void 0:t.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const n=await this.keyValueStorage.getItem(this._authKeys.identityId);return n?(this._hasGuestIdentityId=!0,{id:n,type:"guest"}):null}}catch(n){return mi.log("Error getting stored IdentityId.",n),null}}async storeIdentityId(t){var n;j((n=this.authConfig)==null?void 0:n.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=t.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const wi=(e,t)=>he(pi)(`com.amplify.${e}`,t),ae=({endpointOverride:e})=>t=>e?{url:new Q(e)}:Ro(t);function bt(e){const t=L(e).payload.iss,n={};if(!t)throw new l({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const o=t.replace(/(^\w+:|^)\/\//,"");return n[o]=e,n}async function Si({tokens:e,authConfig:t,identityIdStore:n}){n.setAuthConfig({Cognito:t});const o=await n.loadIdentityId();if(o)return o.id;const i=e!=null&&e.idToken?bt(e.idToken.toString()):{},s=await _i(i,t);return n.storeIdentityId({id:s,type:e?"primary":"guest"}),s}async function _i(e,t){const n=t==null?void 0:t.identityPoolId,o=re(n),i=Ao({endpointResolver:ae({endpointOverride:t.identityPoolEndpoint})});let s;try{s=(await i({region:o},{IdentityPoolId:n,Logins:e})).IdentityId}catch(r){throw $(r),new l(r)}if(!s)throw new l({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return s}const B=new E("CognitoCredentialsProvider"),rt=3e3*1e3;class xt{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){B.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){B.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){const n=t.authenticated,{tokens:o}=t,{authConfig:i}=t;try{j(i==null?void 0:i.Cognito)}catch{return}if(!n&&!i.Cognito.allowGuestAccess)return;const{forceRefresh:s}=t,r=this.hasTokenChanged(o),a=await Si({tokens:o,authConfig:i.Cognito,identityIdStore:this._identityIdStore});return(s||r)&&this.clearCredentials(),n?(Bo(o),this.credsForOIDCTokens(i.Cognito,o,a)):this.getGuestCredentials(a,i.Cognito)}async getGuestCredentials(t,n){var r,a;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return B.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const o=re(n.identityPoolId),i=tt({endpointResolver:ae({endpointOverride:n.identityPoolEndpoint})});let s;try{s=await i({region:o},{IdentityId:t})}catch(c){throw $(c),new l(c)}if((r=s==null?void 0:s.Credentials)!=null&&r.AccessKeyId&&((a=s==null?void 0:s.Credentials)!=null&&a.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+rt;const c={credentials:{accessKeyId:s.Credentials.AccessKeyId,secretAccessKey:s.Credentials.SecretKey,sessionToken:s.Credentials.SessionToken,expiration:s.Credentials.Expiration},identityId:t};return s.IdentityId&&(c.identityId=s.IdentityId,this._identityIdStore.storeIdentityId({id:s.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...c,isAuthenticatedCreds:!1},c}else throw new l({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,n,o){var c,d,u;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return B.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const i=n.idToken?bt(n.idToken.toString()):{},s=re(t.identityPoolId),r=tt({endpointResolver:ae({endpointOverride:t.identityPoolEndpoint})});let a;try{a=await r({region:s},{IdentityId:o,Logins:i})}catch(g){throw $(g),new l(g)}if((c=a==null?void 0:a.Credentials)!=null&&c.AccessKeyId&&((d=a==null?void 0:a.Credentials)!=null&&d.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+rt;const g={credentials:{accessKeyId:a.Credentials.AccessKeyId,secretAccessKey:a.Credentials.SecretKey,sessionToken:a.Credentials.SessionToken,expiration:a.Credentials.Expiration},identityId:o};return a.IdentityId&&(g.identityId=a.IdentityId,this._identityIdStore.storeIdentityId({id:a.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...g,isAuthenticatedCreds:!0,associatedIdToken:(u=n.idToken)==null?void 0:u.toString()},g}else throw new l({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){var n,o;return!!t&&!!((n=this._credentialsAndIdentityId)!=null&&n.associatedIdToken)&&((o=t.idToken)==null?void 0:o.toString())!==this._credentialsAndIdentityId.associatedIdToken}}const Ei=new xt(new Ot(X)),Ti={configure(e,t){const n=lt(e),o=new Mo({sameSite:"lax"}),i=t!=null&&t.ssr?o:X,s=t!=null&&t.ssr?new xt(new Ot(o)):Ei;if(!n.Auth){P.configure(n,t);return}if(t!=null&&t.Auth){P.configure(n,t);return}if(!P.libraryOptions.Auth){M.setAuthConfig(n.Auth),M.setKeyValueStorage(i),P.configure(n,{...t,Auth:{tokenProvider:M,credentialsProvider:s}});return}if(t){const r=P.libraryOptions.Auth;t.ssr!==void 0&&(M.setKeyValueStorage(i),r.credentialsProvider=s),P.configure(n,{Auth:r,...t});return}P.configure(n)},getConfig(){return P.getConfig()}};export{Ti as D};
//# sourceMappingURL=aws-vendor-6GMcr2Ie.js.map
